<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Recipe Picker</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    select { width: 300px; height: 150px; }
    .selected { margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Recipe Picker</h1>
  
  <label for="recipes">Select Recipes:</label><br>
  <select id="recipes" multiple></select>
  
  <div class="selected">
    <h2>Selected Recipes</h2>
    <ul id="selectedList"></ul>
  </div>
  
  <script>
    const endpoint = "http://localhost:8080/v1/graphql";
    const query = `
        query MyQuery {
        recipe {
            recipe_name
        }
        }
    `;

    // Fetch recipes from GraphQL
    async function fetchRecipes() {
      const res = await fetch(endpoint, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ query })
      });

      const json = await res.json();
      return json.data.recipes;
    }

    // Populate picker
    function populatePicker(recipes) {
      const select = document.getElementById("recipes");
      recipes.forEach(recipe => {
        const option = document.createElement("option");
        option.value = recipe.id;
        option.textContent = recipe.name;
        select.appendChild(option);
      });

      select.addEventListener("change", () => {
        const selected = Array.from(select.selectedOptions).map(opt => opt.textContent);
        displaySelected(selected);
      });
    }

    // Display selected recipes
    function displaySelected(selected) {
      const list = document.getElementById("selectedList");
      list.innerHTML = "";
      selected.forEach(name => {
        const li = document.createElement("li");
        li.textContent = name;
        list.appendChild(li);
      });
    }

    // Init
    fetchRecipes().then(populatePicker);
  </script>
</body>
</html>
